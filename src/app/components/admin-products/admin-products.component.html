<div class="p-5 h-screen bg-gray-100">
    <h1 class="text-xl mb-2 ml-10">Administrador de Productos</h1>

    <button (click)="openAddModal()" class="bg-blue-500 text-white font-bold py-2 px-4 rounded">
        Agregar Producto
    </button>

    <div class="overflow-auto rounded-lg ml-10 mr-10 shadow hidden md:block">
        <table class="w-full">
            <thead class="bg-gray-50 border-b-2 border-gray-200">
                <tr>
                    <th class="w-20 p-3 text-sm font-semibold tracking-wide text-left">No.Prod</th>
                    <th class="w-20 p-3 text-sm font-semibold tracking-wide text-left">Nombre</th>
                    <th class="w-20 p-3 text-sm font-semibold tracking-wide text-left">Descripción</th>
                    <th class="w-20 p-3 text-sm font-semibold tracking-wide text-left">Precio</th>
                    <th class="w-20 p-3 text-sm font-semibold tracking-wide text-left">Cantidad Disponible</th>
                    <th class="w-20 p-3 text-sm font-semibold tracking-wide text-left">Opciones</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
                <tr *ngFor="let product of listProdutcs" class="bg-white">
                    <td
                        class="p-3 text-sm text-gray-700 whitespace-nowrap overflow-hidden text-overflow-ellipsis max-w-xs">
                        <a href="#" class="font-bold text-blue-500 hover:underline">{{product.id}}</a>
                    </td>
                    <td
                        class="p-3 text-sm text-gray-700 whitespace-nowrap overflow-hidden text-overflow-ellipsis max-w-xs">
                        {{product.name}}
                    </td>
                    <td
                        class="p-3 text-sm text-gray-700 whitespace-nowrap overflow-hidden text-overflow-ellipsis max-w-xs">
                        {{product.description}}
                    </td>
                    <td
                        class="p-3 text-sm text-gray-700 whitespace-nowrap overflow-hidden text-overflow-ellipsis max-w-xs">
                        {{setMoneyFormat(product.price)}}
                    </td>
                    <td
                        class="p-3 text-sm text-gray-700 whitespace-nowrap overflow-hidden text-overflow-ellipsis max-w-xs">
                        {{product.stock}}
                    </td>
                    <td>
                        <button type="button" (click)="openEditModal(product)"
                            class="text-blue-700 border border-orange-700 hover:bg-orange-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-orange-300 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center me-2 dark:border-orange-500 dark:text-orange-500 dark:hover:text-white dark:focus:ring-orange-800 dark:hover:bg-orange-500">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M16.862 4.487l1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                            </svg>
                            <span class="sr-only">Editar producto</span>
                        </button>
                        <button type="button" (click)="deleteProduct(product.id)"
                            class="text-red-700 border border-red-700 hover:bg-red-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center me-2 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:focus:ring-red-800 dark:hover:bg-red-500">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M14.74 9L14.394 18m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 a51.964 51.964 a0 0 0-3.32 a51.964 a0 0 0 0 c-1.18 1.022 a51.964 a51.964 a51.964 a2.201 va al 3.478 a51.964 a2.201" />
                            </svg>
                            <span class="sr-only">Eliminar producto</span>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>


    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 md:hidden">
        <div *ngFor="let product of listProdutcs" class="bg-white space-y-3 p-4 rounded-lg shadow">
            <div class="flex items-center space-x-2 text-sm">
                <div>
                    <a href="#" class="text-blue-500 font-bold hover:underline">{{product.id}}</a>
                </div>
                <div class="text-gray-500">{{setDateFormat(product.description)}}</div>
            </div>
            <div class="text-sm text-gray-700">
                {{product.stock}}
            </div>
            <div class="text-sm font-medium text-black">
                {{ product.description }}
            </div>
        </div>
    </div>
</div>

<div *ngIf="isEditModalOpen" class="fixed z-10 inset-0 overflow-y-auto">
    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 transition-opacity" aria-hidden="true">
            <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
        </div>

        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

        <div
            class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <div *ngIf="editingProduct" class="bg-white p-6">
                <h3 class="text-lg leading-6 font-medium text-gray-900">Editar Producto</h3>
                <div class="mt-2">
                    <label for="name" class="block text-sm font-medium text-gray-700">Nombre</label>
                    <input id="name" [(ngModel)]="editingProduct.name" name="name" required
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />

                    <label for="description" class="block text-sm font-medium text-gray-700">Descripción</label>
                    <input id="description" [(ngModel)]="editingProduct.description" name="description"
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />

                    <label for="price" class="block text-sm font-medium text-gray-700">Precio</label>
                    <input id="price" type="number" [(ngModel)]="editingProduct.price" name="price" required
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />

                    <label for="stock" class="block text-sm font-medium text-gray-700">Stock</label>
                    <input id="stock" type="number" [(ngModel)]="editingProduct.stock" name="stock" required
                        class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />
                </div>

                <div class="mt-4 flex justify-end">
                    <button type="button" (click)="closeEditModal()"
                        class="bg-gray-300 text-gray-800 p-2 rounded-md hover:bg-gray-400">
                        Cancelar
                    </button>
                    <button (click)="editProduct()" type="button"
                        class="bg-green-600 text-white p-2 rounded-md ml-2 hover:bg-green-700">
                        Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para agregar un producto -->
<div *ngIf="isAddModalOpen" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center">
    <div class="bg-white p-6 rounded-lg shadow-lg w-96" *ngIf="newProduct">
        <h2 class="text-xl font-bold mb-4">Agregar Producto</h2>
        <!-- Campos del formulario -->
        <label class="block text-sm font-medium text-gray-700">Nombre</label>
        <input [(ngModel)]="newProduct.name" name="name" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />

        <label class="block text-sm font-medium text-gray-700">Descripción</label>
        <input [(ngModel)]="newProduct.description" name="description"
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />

        <label class="block text-sm font-medium text-gray-700">Precio</label>
        <input [(ngModel)]="newProduct.price" name="price" type="number" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />

        <label class="block text-sm font-medium text-gray-700">Stock</label>
        <input [(ngModel)]="newProduct.stock" name="stock" type="number" required
            class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2" />

        <!-- Botones para cerrar y guardar -->
        <div class="mt-4 flex justify-end">
            <button type="button" (click)="closeAddModal()"
                class="mr-2 bg-red-500 text-white font-bold py-2 px-4 rounded">
                Cancelar
            </button>
            <button type="button" (click)="saveProduct()" class="bg-blue-500 text-white font-bold py-2 px-4 rounded">
                Guardar
            </button>
        </div>
    </div>
</div>